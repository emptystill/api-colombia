pipeline {
  agent any

  stages {
    stage('Checkout SCM') {
      steps {
        checkout scm
      }
    }

    stage('Install dotnet') {
      environment {
        DOTNET_HOME = tool name: 'dotnet', type: 'io.jenkins.plugins.dotnet.DotNetSDK'
      }
      steps {
        script {
          sh 'dotnet --version'
        }
      }
    }

    stage('Build') {
      steps {
        sh 'dotnet build'
      }
    }

    stage('Test') {
      steps {
        sh 'dotnet test'
      }
    }
  }

  post {
    always {
      cleanWs()
    }
  }
}
